<div flex layout="column" md-whiteframe="3" ng-init=" initData() " layout-padding="50" layout-margin class="md-card p-l-20 p-r-20">
    <form name="form_online_application" >
        <div flex layout-gt-xs="row" layout-xs="column">
            <div flex flex-gt-xs="15" layout-align="center center">
                <img src="images/pcsd_logo.png" class="p-t-5" style="width:100%;">
            </div>
            <div flex layout-align="center" class="m-l-20">
                <h4><strong>Republic of the Philippines</strong> <br>
                    <small>Republic Act 7611</small><br>
                    <small>PALAWAN COUNCIL for SUSTAINABLE DEVELOPMENT</small>
                </h4>
                Date: {{ date_now() | date : 'MMMM d, yyyy'}}
            </div>
        </div>

        <md-divider></md-divider>

        <!-- title -->
        <div flex class="p-t-10 p-b-10">
            <h3 class="col-blue-grey">ONLINE APPLICATION FOR WILDLIFE SPECIAL USE PERMIT (RFF)</h3>
        </div>
        
        <md-divider></md-divider>

        <div flex>
            <h4>
                NELSON P. DEVANADERA <br>
                <small>Executive Director</small><br>
                <small>Palawan Council for Sustainable Development Staff</small>
            </h4>

            Sir: <br>
                
            <span class="p-l-20"></span>In accordance with R.A. 9147 otherwise known as the "Wildlife Resources Conservation and Protection Act", with which I shall familiarize myself and to which strict compliance of same is hereby promised,
             
            <div layout-gt-xs="row" layout-xs="column" class="m-t-20" ng-init="new_application.nationality = user.data.nationality">
                <div class="m-r-20">1. <strong>I,</strong></div> 
                <md-autocomplete style="display:inline" required
                        md-selected-item="new_application.applicant"
                        md-items="x in [user.data.full_name]"
                        md-item-text="x"
                        md-min-length="0"
                        placeholder="Applicant">
                    <md-item-template>
                        {{x}}
                    </md-item-template>
                </md-autocomplete>
                <div class="m-l-20" flex-gt-xs>have the honor to apply for a Wildlife Special Use Permit.</div>
            </div>

            <div layout="column" ng-init="age_array = date_gap(date_now(),user.data.birth_day).split(' ')">
                <div layout-gt-xs="row" layout-xs="column" class="m-t-20">
                    <div class="m-r-20">2. <strong class="col-blue-grey">I am</strong> </div>
                    <div ng-init="new_application.age = to_int(age_array[0]);">
                        <input ng-model="new_application.age" type="number" min="18">
                    </div>
                    <div class="m-l-20" flex-gt-xs>{{age_array[1]}} of age, citizen of </div>
                </div>
                <div layout-gt-xs="row" layout-xs="column" class="m-t-20">
                    <div>
                        <md-select ng-model="new_application.nationality" required>
                            <md-option><em>None</em></md-option>
                            <md-option ng-repeat="x in nationalities" ng-value="x.nationality" >
                                {{x.en_short_name}} - {{x.nationality}}
                            </md-option>
                        </md-select>
                    </div> 
                    <div class="m-l-20" flex-gt-xs>by birth (if by naturalization, submit papers for verification)</div>
                </div>
            </div>

            <div layout-gt-xs="row" layout-xs="column" ng-init="bday = new_application.birth_day = user.data.birth_day; new_application.place_of_birth = user.data.place_of_birth;">
                <div flex>
                    <strong class="col-blue-grey">Date of Birth <cite class="font-10">(must be 18+)</cite></strong>
                    <md-datepicker ng-model="bday" ng-change="new_application.birth_day = to_date(bday)" md-placeholder="Birth Date"
                        md-min-date="minDate" md-max-date="maxDate" md-open-on-focus required></md-datepicker>
                </div>
                <div flex>
                    <md-input-container class="md-block" flex-gt-sm>
                        <label>Place of Birth (Address)</label>
                        <input ng-model="new_application.place_of_birth" required>
                    </md-input-container>
                </div>
            </div>

            <div layout-gt-xs="row" layout-xs="column" 
                ng-init="new_application.residence_address = user.data.current_address;new_application.residence_tel_num = user.data.current_phone;">
                <div flex>
                    <md-input-container class="md-block" flex-gt-sm>
                        <label>Residence Address</label>
                        <input ng-model="new_application.residence_address" required>
                    </md-input-container>
                </div>
                <div flex>
                    <md-input-container class="md-block" flex-gt-sm>
                        <label>Residence Tel. Number</label>
                        <input ng-model="new_application.residence_tel_num" required>
                    </md-input-container>
                </div>
            </div>

            <div layout-gt-xs="row" layout-xs="column">
                <div flex>
                    <md-input-container class="md-block" flex-gt-sm>
                        <label>Business Address</label>
                        <input ng-model="new_application.business_address" required>
                    </md-input-container>
                </div>
                <div flex>
                    <md-input-container class="md-block" flex-gt-sm>
                        <label>Business Tel. Number</label>
                        <input ng-model="new_application.business_tel_num" required>
                    </md-input-container>
                </div>
            </div>

            <div layout-gt-xs="row" layout-xs="column" class="m-t-20" ng-init="new_application.civil_status = user.data.civil_status">
                <div class="m-r-20">3. <strong class="col-blue-grey">I am</strong> </div>
                <md-input-container>
                    <label>Civil Status</label>
                    <md-select ng-model="new_application.civil_status">
                        <md-option value="single"><em>Single</em></md-option>
                        <md-option value="married"><em>Married</em></md-option>
                        <md-option value="widowed"><em>Widowed</em></md-option>
                        <md-option value="separated"><em>Separated</em></md-option>
                    </md-select>
                </md-input-container>
                <div ng-if="new_application.civil_status == 'married'" class="m-l-20" flex-gt-xs>and the name of my spouse/wife </div>
                <md-input-container ng-if="new_application.civil_status == 'married'" class="md-block" flex-gt-sm ng-init="new_application.spouse_name = user.data.spouse_name">
                    <label>Spouse/Wife Name</label>
                    <input ng-model="new_application.spouse_name" required>
                </md-input-container>
            </div>

            <div layout-gt-xs="row" layout-xs="column" class="m-t-20" ng-init="new_application.org_member = 'false';">
                <div class="m-r-20">4. <strong class="col-blue-grey">I am</strong> </div>
                <md-radio-group ng-model="new_application.org_member" required>
                    <md-radio-button value="true" class="md-primary">a member</md-radio-button>
                    <md-radio-button value="false"> not a member </md-radio-button>
                </md-radio-group>
                <div flex class="m-l-10">of a sportsmen and/or game club and/or scientific or conservation society and/or live fish trader association or cooperative.</div>
            </div>

            <div ng-if="new_application.org_member == 'true'">
                <h5 class="col-blue-grey" ng-init="new_application.organizations = ['']" flex>
                    Organization: <md-button class="md-raised" ng-click="new_application.organizations.push('');">Add</md-button>
                </h5>
                <div ng-repeat="x in new_application.organizations"  flex layout-gt-sm="row" >
                    <div flex-gt-sm="5">
                        <i class="fa fa-trash pointer col-red" ng-click="new_application.organizations.splice(new_application.organizations.indexOf(x),1);"></i>
                        {{$index + 1}}.
                    </div>
                    <md-autocomplete
                        class="md-block" flex-gt-sm="30" required
                          md-selected-item="new_application.organizations[$index]"
                          md-items="x in organization_list"
                          md-item-text="x"
                          md-min-length="0"
                          placeholder="Organization">
                        <md-item-template>
                          {{x}}
                        </md-item-template>
                    </md-autocomplete>
                </div>
            </div>
            
            <hr>

            <p>
                5. I intend to collect the following economically important wildlife species for direct trade/commercial purposes:
            </p>

            <br>

            <h5 class="col-blue-grey" ng-init="new_application.specimen = [{}]" flex>
                Specimen: <md-button class="md-raised" ng-click="new_application.specimen.push({});">Add Specimen</md-button>
            </h5>
            
            <div>
                <div ng-repeat="x in new_application.specimen"  flex layout-gt-sm="row" >
                    <div flex-gt-sm="5">
                        <i class="fa fa-trash pointer col-red" ng-click="new_application.specimen.splice(new_application.specimen.indexOf(x),1);"></i>
                        {{$index + 1}}.
                    </div>

                    <md-autocomplete
                        class="md-block" flex-gt-sm="30" required
                          md-selected-item="new_application.specimen[new_application.specimen.indexOf(x)].species_name"
                          md-items="x in rff_specimen_list"
                          md-item-text="x"
                          md-min-length="0"
                          placeholder="Species Name">
                        <md-item-template>
                          {{x}}
                        </md-item-template>
                    </md-autocomplete>

                    <md-input-container class="md-block" flex-gt-sm="10">
                       <label>Quantity</label>
                       <input type="number" min="1" max="9999" ng-model="new_application.specimen[new_application.specimen.indexOf(x)].species_qty" required>
                    </md-input-container>

                    <md-input-container>
                      <label>Unit</label>
                      <md-select ng-model="new_application.specimen[new_application.specimen.indexOf(x)].species_unit" required>
                        <md-option value="pcs">pcs</md-option>
                        <md-option value="kg">kg</md-option>
                        <md-option value="cm">cm</md-option>
                        <md-option value="dozen">dozen</md-option>
                      </md-select>
                    </md-input-container>

                    <md-input-container class="md-block" flex-gt-sm="10">
                       <label>Boxes</label>
                       <input type="number" min="1" max="9999" ng-model="new_application.specimen[new_application.specimen.indexOf(x)].species_boxes" required>
                    </md-input-container>

                    <md-autocomplete
                        class="md-block" flex-gt-sm="30" required
                          md-selected-item="new_application.specimen[new_application.specimen.indexOf(x)].species_des"
                          md-items="x in specimen_quality_list"
                          md-item-text="x"
                          md-min-length="0"
                          placeholder="Classification">
                        <md-item-template>
                          {{x}}
                        </md-item-template>
                    </md-autocomplete>

                </div>
            </div>


            <hr>
            
            <h4 class="col-blue-grey">
                Applicant:
            </h4>
            <div layout="row">
                <md-input-container class="md-block" flex-gt-sm>
                   <label>Applicant's Name</label>
                   <input ng-model="new_application.applicant" required>
                </md-input-container>

                <md-input-container class="md-block" flex-gt-sm>
                   <label>Applicant's Contact Number</label>
                   <input ng-model="new_application.contact" required>
                </md-input-container>
            </div>

            
            <div layout="row">
              <div flex ng-change="upload_attachments(file_drop)"
                  ngf-drop ng-model="file_drop"
                  ngf-allow-dir="true"
                  ngf-drag-over-class="'dragover'"
                  multiple="true">
                <h4 class="col-blue-grey">
                    Attachments : <cite class="font-12">(upload required documents)</cite>
                </h4>
                <div>
                  <ol>
                    <li ng-repeat="x in new_application.attachments"> {{x.name}} <i class="fa fa-trash col-red pointer" 
                      ng-click="new_application.attachments.splice($index,1)"></i> </li>
                  </ol>
                </div>
                <md-progress-linear md-mode="indeterminate" ng-show="uploading_file"></md-progress-linear>
                <md-button class="md-raised" ngf-select="upload_attachments($files)">
                  upload attachments
                </md-button>
              </div>
              <div flex ng-if="user.data.uploads != undefined">
                <h5 class="col-blue-grey">
                    Select from Previous uploads : 
                </h5>
                <ol>
                  <li class="pointer" ng-repeat="x in user.data.uploads" ng-if="!is_on_file_list(x,new_application.attachments)" ng-click="new_application.attachments.push(x)" > {{x.name}} </li>
                </ol>
              </div>
            </div>

        </div>

        <hr class="m-t-20">
        <div ng-show=" is_loading " layout="row" layout-sm="column" layout-align="space-around">
            <md-progress-circular md-mode="indeterminate"></md-progress-circular>
        </div>
        <md-button ng-hide=" is_loading " ng-disabled="form_online_application.$invalid" ng-click="submit_application(new_application,'Application for Wildlife Special Use Permit RFF')" 
            class="md-primary md-raised md-block" >
            <strong class="font-24">Submit Application</strong>
        </md-button>

    </form>
</div>