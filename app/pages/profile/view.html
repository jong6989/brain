<div ng-controller="profile_controller" ng-init="set_page_title('My Profile')">
    <div layout-gt-xs="row" layout-xs="column">
        <div flex-gt-xs="35" layout-padding  ng-show="!is_using_camera"
            ngf-drop ng-model="picFile"
            ngf-allow-dir="true"
            ngf-drag-over-class="'dragover'"
            ngf-multiple="false"
            ngf-pattern="image/*"
            >

            <img ng-hide="is_croping_image()" ng-src="{{ (user.data.profile_picture == undefined)? 'images/user.png' : api_address + user.data.profile_picture }}" alt="use" width="100%" md-whiteframe="3">

            <img class="align-center" ng-show="is_croping_image()" ng-src="{{croppedDataUrl}}" />

            <img-crop ng-show="is_croping_image()" image="picFile  | ngfDataUrl"                 
                result-image="croppedDataUrl" ng-init="croppedDataUrl=''">
            </img-crop>

            <md-progress-linear ng-show="upload_process()" md-mode="determinate" value="{{profile_uploading_rate}}"></md-progress-linear>
            <hr>

            <md-button ng-hide="is_croping_image()" ngf-capture="'camera'" 
                ngf-select ng-model="picFile" accept="image/*">
                Upload Picture
            </md-button>


            <md-button ng-click="toggle_using_camera()">
                Use Camera
            </md-button>

            <md-button ng-show="is_croping_image() && !upload_process()" ng-click="change_profile(croppedDataUrl, picFile.name)">Save</md-button> 
            <md-button ng-show="is_croping_image() && !upload_process()" ng-click="clear_cropping_image()" >Cancel</md-button>

            <hr class="m-t-20 m-b-20">

            <a href="#!/pages/dashboard">
                <md-button class="md-block" >DASHBOARD</md-button>
            </a>
            

        </div>

        <div layout="column" ng-if="is_using_camera">

            <div ng-hide="fromCamera == undefined" class="align-center"><img ng-src="{{croppedDataUrl}}" /></div>
            <md-button ng-if="fromCamera != undefined" ng-click="change_profile(croppedDataUrl, 'camera_captured_image')" >
                Save Image
            </md-button>
            
            <img-crop ng-hide="fromCamera == undefined" image="fromCamera"                 
                result-image="croppedDataUrl" ng-init="croppedDataUrl=''">
            </img-crop>

            <ng-camera
                capture-message="Captured!"
                countdown="3"
                viewer-height="375"
                viewer-width="500"
                crop-height="375"
                crop-width="500"
                output-height="525"
                output-width="700"
                image-format="jpeg"
                jpeg-quality="100"
                action-message="Use this image"
                snapshot="fromCamera"
                shutter-url="shutter.mp3"
            ></ng-camera>
            <md-button ng-click="toggle_using_camera();picFile = null">
                Cancel
            </md-button>
        </div>

        <div flex-gt-xs class="p-l-20">
            <div>
                <hr>
                <strong class="col-grey">User :</strong> {{user.user_name}}
                <hr>
                <strong class="col-grey">Full Name :</strong> {{user.data.first_name}} {{user.data.middle_name}} {{user.data.last_name}}
                <hr>
                <strong class="col-grey">Address :</strong> {{user.data.current_address}}
                <hr>
                <strong class="col-grey">Phone :</strong> {{user.data.current_phone}}
                <hr>
                <strong class="col-grey">Birth Day :</strong> {{user.data.birth_day}}
                <hr>
                <strong class="col-grey">Tax Identification Number :</strong> {{user.data.tin_no}}
                <hr>
                <strong class="col-grey">Birth Place Address :</strong> {{user.data.place_of_birth}}
                <hr>
                <strong class="col-grey">Nationality :</strong> {{user.data.nationality}}
                <hr>
                <strong class="col-grey">Gender :</strong> {{user.data.gender}}
                <hr>
                <strong class="col-grey">Civil Status :</strong> {{user.data.civil_status}}
                <hr ng-if="user.data.civil_status == 'married'">
                <strong ng-if="user.data.civil_status == 'married'" class="col-grey">Spouse Name :</strong> {{user.data.spouse_name}}
                <hr>
                <strong class="col-grey">Father :</strong> {{user.data.father}}
                <hr>
                <strong class="col-grey">Mother :</strong> {{user.data.mother}}
                <hr>
                <strong class="col-grey">Government Issued Identification :</strong> 
                    name : {{user.data.gov_id.name}}, 
                    number : {{user.data.gov_id.number}}, 
                    Date Issued : {{user.data.gov_id.date_issued}}, 
                    Place Issued : {{user.data.gov_id.place_issued}}, 
                    Valid Until : {{user.data.gov_id.valid_until}}
                <hr>
            </div>

            <div layout-gt-xs="row" layout-xs="column">

                <div flex 
                    ng-change="upload_files(file_drop)"
                    ngf-drop ng-model="file_drop"
                    ngf-allow-dir="true"
                    multiple
                    ngf-drag-over-class="'dragover'"
                    ngf-multiple="true">
                    <h5 class="col-blue-grey">
                        My Uploads : 
                    </h5>
                    <ol ng-if="user.data.uploads != undefined">
                        <li ng-repeat="x in user.data.uploads" > {{x.name}} - 
                          <i class="fa fa-trash col-red pointer" 
                            ng-click="user.data.uploads.splice($index,1);update_profile('uploads',user.data.uploads)"></i>
                        </li>
                    </ol>
                    <md-progress-linear md-mode="indeterminate" ng-show="uploading_file"></md-progress-linear>
                    <md-button class="" ngf-select="upload_files($files)">
                        Select Upload
                    </md-button>
                </div>
                
            </div>
        </div>
    </div>

    

    
</div>